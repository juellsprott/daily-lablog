---
title: "Visualizing BLIP-2 OPT-2.7b captioning results"
date: "2023-05-17"
updated: "2023-05-17"
author: juellsprott
menu: true
github: https://github.com/juellsprott/thesis-novel-objects
tags:
  - thesis, blip-2, noun, pandas

---



Tested BLIP-2 captioning using various decode methods after discovering how to tweak the model using [this GitHub issue](https://github.com/huggingface/transformers/issues/22146) about modifying BLIP-2 parameters. By default, model.generate() uses *greedy decode* which takes the token with the highest probability on each time step:
```
model.generate(**inputs, max_new_tokens=20)
```

The function can be tweaked to use nucleus sampling with the following arguments:


```
model.generate(**inputs, do_sample=True, top_p=0.9, max_new_tokens=20)
```

And beam search with these arguments:

```
model.generate(**inputs, num_beams=5, max_new_tokens=30, repetition_penalty=1.0, length_penalty=1.0, temperature=1)
```

Below, a table is shown containing all captioning results together with the images and their accompanying data:

<style>
    .custom-iframe {
        margin-left: -200px; /* Adjust the margin values as per your needs */
        margin-top: 20px;
    }
</style>

<div class="custom-iframe">
    <iframe src="/daily-lablog/_data/greedy_beam_questions_similarity.html" width="150%" height="2000px"></iframe>
</div>

Data visualized below:

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<div id="grouped-bar-chart"></div>
<script>
    // Load the JSON file
    fetch('/daily-lablog/_data/grouped_color.json')
        .then(response => response.json())
        .then(data => {
            // Parse the JSON data and modify the layout
            const figure = JSON.parse(data);
            
            // Adjust the size of the plot by modifying the layout object
            figure.layout.width = 1000; // Set the desired width in pixels
            figure.layout.height = 600; // Set the desired height in pixels
            
            // Render the Plotly figure with the updated layout
            Plotly.newPlot('grouped-bar-chart', figure.data, figure.layout);
        })
        .catch(error => console.error('Error:', error));
</script>


